<!DOCTYPE html>
<html>
    <head>
        <meta charset="utf-8">
        <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
        <title>Brilliant Jasper Report</title>
        <meta name="viewport" content="width=device-width">

        <!-- syntax highlighting CSS -->
        <link rel="stylesheet" href="/css/syntax.css">

        <!-- Custom CSS -->
        <link rel="stylesheet" href="/css/main.css">

    </head>
    <body>

        <div class="site">
          <div class="header">
            <h1 class="title"><a href="/">New realm of huhukun</a></h1>
            <a class="extra" href="/">home</a>
          </div>

          <h2>Brilliant Jasper Report</h2>
<p class="meta">02 Jan 2014</p>

<div class="post">
<p>Today i have to make some complex report including multiple group and functions of mysql in query.</p>

<p>I am impressed by the power of jasper report.
At beginning, when i found how complex the report is, i was just freak out.
The requirement is:
1 search the record based on opening hour not the normal 00:00:00 to 23:59:59 
2 show sale record in groups based on opening date and category and statistic the revenue for both group.</p>

<p>Challenge complete!!</p>

<p>1 By after research, i found how wonderful function the mysql provided for developer. So i could just use sql  query to process the records i need.
using the following in query:</p>

<div class="highlight"><pre><code class="sql"><span class="p">(</span><span class="k">case</span> <span class="k">when</span> <span class="p">[</span><span class="k">some</span> <span class="n">condition</span><span class="p">]</span> <span class="k">then</span> <span class="k">else</span> <span class="k">end</span><span class="p">)</span> <span class="k">as</span> <span class="k">column_name</span>
</code></pre></div>

<p>it helps me to get the business date the record belong to. example:</p>

<div class="highlight"><pre><code class="sql"><span class="p">(</span><span class="k">case</span> <span class="k">when</span> <span class="n">time</span> <span class="o">&lt;</span> <span class="err">$</span><span class="n">P</span><span class="err">{</span><span class="n">startTime</span><span class="err">}</span> <span class="k">then</span> <span class="n">SUBDATE</span><span class="p">(</span><span class="nb">date</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span> <span class="k">else</span> <span class="nb">date</span> <span class="k">end</span><span class="p">)</span>
</code></pre></div>

<p>The following helps me to find the right record based on given period:</p>

<div class="highlight"><pre><code class="sql"><span class="p">(</span><span class="k">select</span> <span class="n">concat</span><span class="p">(</span><span class="nb">date</span><span class="p">,</span><span class="s1">&#39; &#39;</span><span class="p">,</span><span class="n">time</span><span class="p">))</span> <span class="k">between</span> <span class="err">$</span><span class="n">P</span><span class="err">{</span><span class="n">fromDate</span><span class="err">}</span> <span class="k">and</span>  <span class="err">$</span><span class="n">P</span><span class="err">{</span><span class="n">toDate</span><span class="err">}</span>
</code></pre></div>

<p>2 another challenge is the multiple group statistics of records. Unfortunately, there is some problem in ireport designer. Therefore, i have to use xml to modify the report layout.</p>

<p>The group statistics function is brilliant. The variable could be reset based on report, column, group (if you have multiple group, you could choose one of them) page or even report! That helps me a lot.</p>

</div>


          <div class="footer">
            <div class="contact">
              <p>
                Kun Zhou<br />
                A pro-programmer<br />
                clirochina@gmail.com
              </p>
            </div>
            <div class="contact">
              <p>
                <a href="https://github.com/keane">github.com/keane</a><br />
                <a href="https://twitter.com/keane_zhou">twitter.com/keane_zhou</a><br />
              </p>
            </div>
          </div>
        </div>

    </body>
</html>
